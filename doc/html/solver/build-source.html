

<!DOCTYPE html>
<html class="writer-html5" lang="en" data-content_root="../">
<head>
  <meta charset="utf-8" /><meta name="viewport" content="width=device-width, initial-scale=1" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>5.3. Build from source (for developers) &mdash; MFiX 25.2.1 documentation</title>
      <link rel="stylesheet" type="text/css" href="../_static/pygments.css?v=03e43079" />
      <link rel="stylesheet" type="text/css" href="../_static/css/theme.css?v=e59714d7" />
      <link rel="stylesheet" type="text/css" href="../_static/custom.css?v=bc05c87d" />
      <link rel="stylesheet" type="text/css" href="../_static/mfix.css?v=31071079" />

  
      <script src="../_static/jquery.js?v=5d32c60e"></script>
      <script src="../_static/_sphinx_javascript_frameworks_compat.js?v=2cd50e6c"></script>
      <script src="../_static/documentation_options.js?v=b06fed7c"></script>
      <script src="../_static/doctools.js?v=9bcbadda"></script>
      <script src="../_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="../_static/js/theme.js"></script>
    <link rel="author" title="About these documents" href="../about.html" />
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="6. Running the solver" href="run.html" />
    <link rel="prev" title="5.2. Building a Batch Solver" href="build-batch.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >


          
          
          <a href="../index.html">
            
              <img src="../_static/logo.png" class="logo" alt="Logo"/>
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

<br/>
<div class="version-display">
  <span class="version-text">Version: 25.2</span>
</div>



        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../about.html">1. About MFiX</a></li>
<li class="toctree-l1"><a class="reference internal" href="../getting_started/index.html">2. Getting started</a></li>
<li class="toctree-l1"><a class="reference internal" href="../tutorials/index.html">3. Tutorials</a></li>
<li class="toctree-l1"><a class="reference internal" href="../model_setup/index.html">4. Model guide</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="build.html">5. Building the solver</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="build-custom.html">5.1. Custom interactive solver</a></li>
<li class="toctree-l2"><a class="reference internal" href="build-batch.html">5.2. Batch solver</a></li>
<li class="toctree-l2 current"><a class="current reference internal" href="#">5.3. Build from git or source tarball</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#obtaining-mfix-source">5.3.1. Obtaining MFiX source</a></li>
<li class="toctree-l3"><a class="reference internal" href="#content-of-the-mfix-source-tarball">5.3.2. Content of the MFiX source tarball</a></li>
<li class="toctree-l3"><a class="reference internal" href="#building-solver-from-source">5.3.3. Building solver from source</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#configuring">5.3.3.1. Configuring</a></li>
<li class="toctree-l4"><a class="reference internal" href="#id1">5.3.3.2. Building</a></li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="run.html">6. Running the solver</a></li>
<li class="toctree-l1"><a class="reference internal" href="../visualization/index.html">7. Visualization</a></li>
<li class="toctree-l1"><a class="reference internal" href="../user_interface_reference.html">8. GUI reference</a></li>
<li class="toctree-l1"><a class="reference internal" href="../queue.html">9. Running interactive solver job in queue</a></li>
<li class="toctree-l1"><a class="reference internal" href="../reference/user_defined_functions.html">10. User-Defined Functions</a></li>
<li class="toctree-l1"><a class="reference internal" href="../mfix_on_joule.html">11. Running MFiX on Joule</a></li>
<li class="toctree-l1"><a class="reference internal" href="../reference/index.html">12. Keyword reference</a></li>
<li class="toctree-l1"><a class="reference internal" href="../faq.html">13. Frequently asked questions</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">MFiX</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../index.html" class="icon icon-home" aria-label="Home"></a></li>
          <li class="breadcrumb-item"><a href="build.html"><span class="section-number">5. </span>Building the solver</a></li>
      <li class="breadcrumb-item active"><span class="section-number">5.3. </span>Build from source (for developers)</li>
      <li class="wy-breadcrumbs-aside">
            <a href="../_sources/solver/build-source.rst.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section id="build-from-source-for-developers">
<span id="developers"></span><h1><span class="section-number">5.3. </span>Build from source (for developers)<a class="headerlink" href="#build-from-source-for-developers" title="Link to this heading">¶</a></h1>
<section id="obtaining-mfix-source">
<span id="building"></span><h2><span class="section-number">5.3.1. </span>Obtaining MFiX source<a class="headerlink" href="#obtaining-mfix-source" title="Link to this heading">¶</a></h2>
<p>This section describes how developers build MFiX packages for
distribution. Most users will not need to do this.</p>
<p>Building from source requires the MFiX source tarball, which can be obtained on
the <a class="reference external" href="https://mfix.netl.doe.gov/mfix/download-mfix">MFiX download page</a>.
Extract the tarball and go into the top level source directory:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>(bash)$ tar xf mfix-25.2.tar.gz
(bash)$ cd mfix-25.2
(bash)$ pwd
/home/user/mfix-25.2
</pre></div>
</div>
</section>
<section id="content-of-the-mfix-source-tarball">
<h2><span class="section-number">5.3.2. </span>Content of the MFiX source tarball<a class="headerlink" href="#content-of-the-mfix-source-tarball" title="Link to this heading">¶</a></h2>
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p>Folder</p></th>
<th class="head"><p>Description</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>model</p></td>
<td><p>Source code for the MFiX solver</p></td>
</tr>
<tr class="row-odd"><td><p>postmfix</p></td>
<td><p>Source code for the post-processing tool postmfix</p></td>
</tr>
<tr class="row-even"><td><p>queue_templates</p></td>
<td><p>Templates to submit jobs on HPC systems</p></td>
</tr>
<tr class="row-odd"><td><p>tutorials</p></td>
<td><p>Examples of simulations ready to run from the GUI</p></td>
</tr>
<tr class="row-even"><td><p>tests</p></td>
<td><p>Simple simulations used for regression tests</p></td>
</tr>
<tr class="row-odd"><td><p>legacy_tutorials</p></td>
<td><p>Old examples of simulations, meant to be run from
command line</p></td>
</tr>
<tr class="row-even"><td><p>legacy_tests</p></td>
<td><p>Old tets cases meant to be run from command line</p></td>
</tr>
</tbody>
</table>
<div class="admonition note">
<p class="admonition-title">Note</p>
<ol class="arabic simple">
<li><p>The source code is also available from the GUI, from the “Editor” tab.
Files are located in the “MFiX source” file explorer. Selecting a file will
open it in the editor. Users wishing to modify the source code should copy
a file to the project directory. This is accomplished automatically by clicking
“Copy” when prompted “Copy to project directory for editing?”</p></li>
<li><p>It is recommended to study the simulations files in the “tutorials” folder.
These simulations can be loaded in the GUI from Main menu&gt;New project.
Interested users can study files located in the legacy_tutorials and
legacy_tests folders. However, these are provided as examples that are
compatible with older versions of MFiX (2016-1 and prior).</p></li>
</ol>
</div>
</section>
<section id="building-solver-from-source">
<h2><span class="section-number">5.3.3. </span>Building solver from source<a class="headerlink" href="#building-solver-from-source" title="Link to this heading">¶</a></h2>
<p>You can build the <a class="reference internal" href="build-batch.html#build-batch"><span class="std std-ref">Batch solver</span></a> from source, without the MFiX Conda
package installed. This is how MFiX was built in version 2016 and earlier.</p>
<p>You will need a Fortran compiler, GNU Make and CMake version 3.16 or newer.  Note that the
MFiX Conda package provides all of these, so if you do not use Conda, you have to use your
system package manager to install these prerequisites.  The MFiX team does not provide
support for this option.</p>
<p>Run <code class="docutils literal notranslate"><span class="pre">cmake</span></code> to configure MFiX and generate a Makefile, then run <code class="docutils literal notranslate"><span class="pre">make</span></code> to build the MFiX solver.</p>
<p>Running <code class="docutils literal notranslate"><span class="pre">cmake</span></code> will generate a <code class="docutils literal notranslate"><span class="pre">CMakeCache.txt</span></code> file in the directory it is
invoked from. Please include <code class="docutils literal notranslate"><span class="pre">CMakeCache.txt</span></code> when posting a question about
build issues to the forum.</p>
<section id="configuring">
<h3><span class="section-number">5.3.3.1. </span>Configuring<a class="headerlink" href="#configuring" title="Link to this heading">¶</a></h3>
<p>The default configuration for MFiX is serial with optimizations and debug symbols (standard optimization; for GFortran use flags <code class="docutils literal notranslate"><span class="pre">-g</span> <span class="pre">-O2</span></code>):</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Using an “out of source” build is recommended. Create a new directory, <code class="docutils literal notranslate"><span class="pre">cd</span></code>
to that directory, and run <code class="docutils literal notranslate"><span class="pre">cmake</span> <span class="pre">&lt;path&gt;</span></code> where <code class="docutils literal notranslate"><span class="pre">&lt;path&gt;</span></code> is the top-level
MFiX source directory (containing <code class="docutils literal notranslate"><span class="pre">CMakeLists.txt</span></code>). Out of source builds
are convenient for having different solvers built with different
configurations. The build directory can be whatever you want;
<code class="docutils literal notranslate"><span class="pre">release-build</span></code> and <code class="docutils literal notranslate"><span class="pre">debug-build</span></code> used here are just examples.</p>
</div>
<p>To configure the MFiX solver in serial with debug mode (no optimization; for GFortran use flags <code class="docutils literal notranslate"><span class="pre">-g</span> <span class="pre">-O0</span></code>):</p>
<div class="highlight-shell-session notranslate"><div class="highlight"><pre><span></span><span class="gp">$ </span>mkdir<span class="w"> </span>debug-build
<span class="gp">$ </span><span class="nb">cd</span><span class="w"> </span>debug-build
<span class="gp">$ </span>cmake<span class="w"> </span>..<span class="w"> </span>-DCMAKE_BUILD_TYPE<span class="o">=</span>Debug
</pre></div>
</div>
<p>If <code class="docutils literal notranslate"><span class="pre">mpifort</span></code> is your MPI compiler wrapper command, then to configure the MFiX solver with DMP with optimizations and debug symbols:</p>
<div class="highlight-shell-session notranslate"><div class="highlight"><pre><span></span><span class="gp">$ </span>mkdir<span class="w"> </span>release-build
<span class="gp">$ </span><span class="nb">cd</span><span class="w"> </span>release-build
<span class="gp">$ </span>cmake<span class="w"> </span>..<span class="w"> </span>-DCMAKE_BUILD_TYPE<span class="o">=</span>RelWithDebInfo<span class="w"> </span>-DENABLE_MPI<span class="o">=</span><span class="m">1</span>
<span class="gp">$ </span>cmake<span class="w"> </span>..<span class="w"> </span><span class="c1"># same thing (RelWithDebInfo is the default CMAKE_BUILD_TYPE)</span>
</pre></div>
</div>
<p>If <code class="docutils literal notranslate"><span class="pre">mpifort</span></code> is your MPI compiler wrapper command, then to configure the MFiX solver with DMP with debug mode:</p>
<div class="highlight-shell-session notranslate"><div class="highlight"><pre><span></span><span class="gp">$ </span>mkdir<span class="w"> </span>debug-build
<span class="gp">$ </span><span class="nb">cd</span><span class="w"> </span>debug-build
<span class="gp">$ </span>cmake<span class="w"> </span>..<span class="w"> </span>-DCMAKE_BUILD_TYPE<span class="o">=</span>Debug<span class="w"> </span>-DENABLE_MPI<span class="o">=</span><span class="m">1</span>
</pre></div>
</div>
<p>To specify the Fortran compiler, define CMAKE_Fortran_COMPILER:</p>
<div class="highlight-shell-session notranslate"><div class="highlight"><pre><span></span><span class="gp">$ </span>cmake<span class="w"> </span>..<span class="w"> </span>-DCMAKE_Fortran_COMPILER<span class="o">=</span>ifort<span class="w">  </span><span class="c1"># for example</span>
</pre></div>
</div>
<p>To add specific Fortran compiler flags, define CMAKE_Fortran_FLAGS:</p>
<div class="highlight-shell-session notranslate"><div class="highlight"><pre><span></span><span class="gp">$ </span>cmake<span class="w"> </span>..<span class="w"> </span>-DCMAKE_Fortran_FLAGS<span class="o">=</span><span class="s2">&quot;-O0 -g -Wall -fcheck=all&quot;</span><span class="w">  </span><span class="c1"># for example</span>
</pre></div>
</div>
<p>To configure with SMP support:</p>
<div class="highlight-shell-session notranslate"><div class="highlight"><pre><span></span><span class="gp">$ </span>cmake<span class="w"> </span>..<span class="w"> </span>-ENABLE_OpenMP<span class="o">=</span>ON
</pre></div>
</div>
<p>Options can be combined in a single command:</p>
<div class="highlight-shell-session notranslate"><div class="highlight"><pre><span></span><span class="gp">$ </span>cmake<span class="w"> </span>..<span class="w"> </span>-ENABLE_OpenMP<span class="o">=</span>ON<span class="w"> </span>-DCMAKE_Fortran_COMPILER<span class="o">=</span>ifort<span class="w"> </span>-DCMAKE_Fortran_FLAGS<span class="o">=</span><span class="s2">&quot;-O0 -g -Wall -fcheck=all&quot;</span>
</pre></div>
</div>
<p><strong>Example with gfortran, serial optimized solver configuration:</strong></p>
<div class="highlight-shell-session notranslate"><div class="highlight"><pre><span></span><span class="gp">$ </span>cmake<span class="w"> </span>..<span class="w"> </span>-DENABLE_MPI<span class="o">=</span><span class="m">0</span><span class="w"> </span>-DCMAKE_Fortran_COMPILER<span class="o">=</span>gfortran<span class="w"> </span>-DCMAKE_Fortran_FLAGS<span class="o">=</span><span class="s2">&quot;-O2 -g&quot;</span>
</pre></div>
</div>
<p><strong>Example with gfortran, serial optimized solver for current CPU configuration :</strong></p>
<div class="highlight-shell-session notranslate"><div class="highlight"><pre><span></span><span class="gp">$ </span>cmake<span class="w"> </span>..<span class="w"> </span>-DENABLE_MPI<span class="o">=</span><span class="m">0</span><span class="w"> </span>-DCMAKE_Fortran_COMPILER<span class="o">=</span>gfortran<span class="w"> </span>-DCMAKE_Fortran_FLAGS<span class="o">=</span><span class="s2">&quot;-march=native -O3&quot;</span>
</pre></div>
</div>
<p><strong>Example with gfortran, DMP optimized solver configuration:</strong></p>
<div class="highlight-shell-session notranslate"><div class="highlight"><pre><span></span><span class="gp">$ </span>cmake<span class="w"> </span>..<span class="w"> </span>-DENABLE_MPI<span class="o">=</span><span class="m">1</span><span class="w"> </span>-DMPI_Fortran_COMPILER<span class="o">=</span>mpifort<span class="w"> </span>-DCMAKE_Fortran_FLAGS<span class="o">=</span><span class="s2">&quot;-O2 -g&quot;</span>
</pre></div>
</div>
<p><strong>Example with gfortran, serial debug mode solver configuration:</strong></p>
<div class="highlight-shell-session notranslate"><div class="highlight"><pre><span></span><span class="gp">$ </span>cmake<span class="w"> </span>..<span class="w"> </span>-DENABLE_MPI<span class="o">=</span><span class="m">0</span><span class="w"> </span>-DCMAKE_Fortran_COMPILER<span class="o">=</span>gfortran<span class="w"> </span>-DCMAKE_Fortran_FLAGS<span class="o">=</span><span class="s2">&quot;-O0 -fcheck=all -g&quot;</span>
</pre></div>
</div>
<p><strong>Example with gfortran, DMP debug mode solver configuration:</strong></p>
<div class="highlight-shell-session notranslate"><div class="highlight"><pre><span></span><span class="gp">$ </span>cmake<span class="w"> </span>..<span class="w"> </span>-DENABLE_MPI<span class="o">=</span><span class="m">1</span><span class="w"> </span>-DMPI_Fortran_COMPILER<span class="o">=</span>mpifort<span class="w"> </span>-DCMAKE_Fortran_FLAGS<span class="o">=</span><span class="s2">&quot;-O0 -fcheck=all -g&quot;</span>
</pre></div>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>For DMP support, defining <code class="docutils literal notranslate"><span class="pre">-DENABLE_MPI=1</span></code> is required. Defining
<code class="docutils literal notranslate"><span class="pre">CMAKE_Fortran_COMPILER</span></code> as your MPI wrapper (<code class="docutils literal notranslate"><span class="pre">mpifort</span></code>) is recommended,
but not strictly required. CMake should automatically detect MPI include
files and libraries for your default compiler, but specifying
<code class="docutils literal notranslate"><span class="pre">CMAKE_Fortran_COMPILER</span></code> is better to ensure you are using the exact
compiler you intend to use.</p>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>CMake uses configurations values from both <code class="docutils literal notranslate"><span class="pre">CMakeCache.txt</span></code> and from
command line arguments. Command line arguments take precedence over
<code class="docutils literal notranslate"><span class="pre">CMakeCache.txt</span></code>, but <code class="docutils literal notranslate"><span class="pre">CMakeCache.txt</span></code> is used if nothing is specified on
the command line. For instance, if you run <code class="docutils literal notranslate"><span class="pre">cmake</span> <span class="pre">..</span>
<span class="pre">-DCMAKE_Fortran_FLAGS=&quot;-fcheck=all&quot;</span></code>, and then run <code class="docutils literal notranslate"><span class="pre">cmake</span> <span class="pre">..</span></code> again (in
the same build directory), <code class="docutils literal notranslate"><span class="pre">-fcheck=all</span></code> will still be used (because it is
still in <code class="docutils literal notranslate"><span class="pre">CMakeCache.txt</span></code>). If this is not what you want, either edit
<code class="docutils literal notranslate"><span class="pre">CMakeCache.txt</span></code>, or just delete <code class="docutils literal notranslate"><span class="pre">CMakeCache.txt</span></code> and run <code class="docutils literal notranslate"><span class="pre">cmake</span></code> again
with different options.  The <code class="docutils literal notranslate"><span class="pre">build_mfixsolver</span></code> script removes <code class="docutils literal notranslate"><span class="pre">CMakeCache.txt</span></code>
each time it runs so old options are not reapplied.</p>
</div>
</section>
<section id="id1">
<h3><span class="section-number">5.3.3.2. </span>Building<a class="headerlink" href="#id1" title="Link to this heading">¶</a></h3>
<p>After configuring, build with make. For further details about the make utility,
type <code class="docutils literal notranslate"><span class="pre">man</span> <span class="pre">make</span></code> at the prompt.</p>
<div class="highlight-shell-session notranslate"><div class="highlight"><pre><span></span><span class="gp">$ </span>make
<span class="gp">$ </span>make<span class="w"> </span>-j<span class="w">        </span><span class="c1"># for parallel build jobs</span>
<span class="gp">$ </span>make<span class="w"> </span><span class="nv">VERBOSE</span><span class="o">=</span><span class="m">1</span><span class="w"> </span><span class="c1"># to view the full command lines used for compiling and linking</span>
</pre></div>
</div>
<p>At the end of a successful build, the MFiX solver will be located in the current directory.
The solver is called <code class="docutils literal notranslate"><span class="pre">mfixsolver</span></code> on Linux.</p>
</section>
</section>
</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="build-batch.html" class="btn btn-neutral float-left" title="5.2. Building a Batch Solver" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="run.html" class="btn btn-neutral float-right" title="6. Running the solver" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2025, NETL Multiphase Flow Science Team.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>