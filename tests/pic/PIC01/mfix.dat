########################################################################
#  DEM - Terminal Velocity                                             #
#                                                                      #
# Author:  Sreekanth Pannala                            Date: 01-2010  #
# Modified: J. Musser                                   Date: 05-2014  #
# Modified: A. Vaidheeswaran (PIC)                      Date: 08-2018  #
#                                                                      #
#  Comment: The particle-particle and particle-wall spring constants   #
#  were made very small O(10) so that the test case runs in a few min. #
#  This causes larger errros between the RK4 solution and MFIX, but    #
#  at acceptable levels, percent relative error remains below 0.6% for #
#  velocity and below 0.2% for position.                               #
#                                                                      #
#  References:                                                         #
#                                                                      #
#  R. Garg, J. Galvin, T. Li, and S. Pannala, Documentation of open-   #
#     source MFIX-DEM software for gas-solids flows," from URL:        #
#     https://mfix.netl.doe.gov/documentation/dem_doc_2012-1.pdf,      #
#                                                                      #
########################################################################

  RUN_NAME = 'TERM'
  DESCRIPTION = 'PIC: Single particle, terminal velocity'

#_______________________________________________________________________
# RUN CONTROL SECTION

  RUN_TYPE = 'NEW'
  UNITS = 'SI'

  TIME =   0.00
  TSTOP =  0.35

  DT =     1.00d-5
  DT_MAX = 1.00d-5

  ENERGY_EQ = .F.
  SPECIES_EQ(0:1) = .F.  .F.

  MOMENTUM_X_EQ(0:1) = .F. .F.
  MOMENTUM_Y_EQ(0:1) = .F. .F.
  MOMENTUM_Z_EQ(0:1) = .F. .F.

  CALL_USR = .TRUE.
  DRAG_TYPE = 'USER_DRAG'

  DES_INTERP_ON = .T.
  DES_INTERP_MEAN_FIELDS= .T.
  DES_INTERP_SCHEME = 'LINEAR_HAT'
  DES_EXPLICITLY_COUPLED= .T.

#_______________________________________________________________________
# NUMERICAL SECTION

  MAX_NIT = 250
  TOL_RESID = 1.E-4

  NORM_G = 0

#_______________________________________________________________________
# GEOMETRY SECTION

  COORDINATES    = 'CARTESIAN'

  XLENGTH = 0.01   IMAX  =  5 
  YLENGTH = 0.30   JMAX  =  60
  ZLENGTH = 0.01   KMAX  =  5

#_______________________________________________________________________
# MATERIAL SECTION

! Gas Section
!---------------------------------------------------------------------//

  RO_g0 = 1.2      ! (kg/m^3)
  MU_g0 = 1.8d-5   ! (Pa.s)

! Particle Section
!---------------------------------------------------------------------//
  MMAX = 1
  EP_star = 0.40
  GENER_PART_CONFIG = .T.
  
  FRIC_EXP_PIC = 3.0
  PSFAC_FRIC_PIC = 100.0

  MPPIC_COEFF_EN1 = 0.85      !change from 0.85
  MPPIC_COEFF_EN_WALL = 0.85  ! change from 0.85
  MPPIC_COEFF_ET_WALL = 1.00  ! new

! Solids phase 1:
!---------------------------------------------------------------------//
  SOLIDS_MODEL(1) = 'PIC'

  D_p0(1) =  1.0d-4  ! (m)
  RO_s0(1) = 2.0d3   ! (kg/m^3)

#_______________________________________________________________________
# INITIAL CONDITIONS SECTION

  IC_X_w(1)   =   0.00   ! (m)
  IC_X_e(1)   =   0.01   ! (m)
  IC_Y_s(1)   =   0.00   ! (m)
  IC_Y_n(1)   =   0.30   ! (m)
  IC_Z_b(1)   =   0.00   ! (m)
  IC_Z_t(1)   =   0.01   ! (m)

  IC_EP_g(1)  =   1.0

  IC_U_g(1)   =   0.00   ! (m/sec)
  IC_V_g(1)   =   0.40   ! (m/sec)
  IC_W_g(1)   =   0.00   ! (m/sec)

  IC_U_s(1,1) =   0.00   ! (m/sec)
  IC_V_s(1,1) =   0.00   ! (m/sec)
  IC_W_s(1,1) =   0.00   ! (m/sec)

  IC_X_w(2)   =   0.0    ! (m)
  IC_X_e(2)   =   0.01  ! (m)
  IC_Z_b(2)   =   0.0    ! (m)
  IC_Z_t(2)   =   0.01  ! (m)
  IC_Y_s(2)   =   0.285  ! (m)
  IC_Y_n(2)   =   0.295  ! (m)

  IC_EP_g(2)  =   0.9999 ! ()

  IC_U_g(2)   =   0.00   ! (m/sec)
  IC_V_g(2)   =   0.40   ! (m/sec)
  IC_W_g(2)   =   0.00   ! (m/sec)

  IC_U_s(2,1) =   0.00   ! (m/sec)
  IC_V_s(2,1) =   0.00   ! (m/sec)
  IC_W_s(2,1) =   0.00   ! (m/sec)

  IC_THETA_M(2,1) = 0.0
  IC_PIC_CONST_STATWT(2,1) = 100
  !IC_PIC_CONST_STATWT(2,1) = 45800

#_______________________________________________________________________
# BOUNDARY CONDITIONS SECTION


! Gass Mass Inlet:
!---------------------------------------------------------------------//
  BC_X_w(1) =     0.00   ! (m)
  BC_X_e(1) =     0.01   ! (m)
  BC_Y_s(1) =     0.00   ! (m)
  BC_Y_n(1) =     0.00   ! (m)
  BC_Z_b(1) =     0.00   ! (m)
  BC_Z_t(1) =     0.01   ! (m)

  BC_TYPE(1) =    "MI"

  BC_P_g(1) =     0.00   ! (Pa)

  BC_EP_g(1) =    1.0

  BC_U_g(1)   =   0.00   ! (m/sec)
  BC_V_g(1)   =   0.40   ! (m/sec)
  BC_W_g(1)   =   0.00   ! (m/sec)


! Pressure Outflow:
!---------------------------------------------------------------------//
  BC_X_w(2) =     0.00   ! (m)
  BC_X_e(2) =     0.01   ! (m)
  BC_Z_b(2) =     0.00   ! (m)
  BC_Z_t(2) =     0.01   ! (m)
  BC_Y_s(2) =     0.30   ! (m)
  BC_Y_n(2) =     0.30   ! (m)

  BC_TYPE(2) =    "PO"

  BC_P_g(2)   =   0.00   ! (Pa)


! Free slip walls:
!---------------------------------------------------------------------//
  BC_X_w(3) =     0.00   0.00   0.00   0.01   ! (m)
  BC_X_e(3) =     0.01   0.01   0.00   0.01   ! (m)
  BC_Y_s(3) =     0.00   0.00   0.00   0.00   ! (m)
  BC_Y_n(3) =     0.30   0.30   0.30   0.30   ! (m)
  BC_Z_b(3) =     0.00   0.01   0.00   0.00   ! (m)
  BC_Z_t(3) =     0.00   0.01   0.01   0.01   ! (m)

  BC_TYPE(3) =  4*'FSW'


#_______________________________________________________________________
# USER OUTPUT CONTROL

  USR_DT(1) = 1.0d-2
  USR_TYPE(1) = 'ASCII'
  USR_VAR(1) =  'Particle position and velocity'


#_______________________________________________________________________
# OUTPUT CONTROL SECTION

  FULL_LOG = .T.    ! display residuals on screen
  NLOG = 25         ! frequency to updated log file (.LOG)

! Output Control
  RES_DT =   0.10    ! frequency to write restart file (.RES)
  SPX_DT =   0.10    ! frequency to updated data fliles (.SPx)

  PRINT_DES_DATA = .T.

  GROUP_RESID = .T.

  NLOG = 50
  FULL_LOG = .T.

#_______________________________________________________________________
# DMP SETUP

  NODESI = 1   NODESJ = 1   NODESK = 1

  ENABLE_DMP_LOG = .F.
  CHK_BATCHQ_END = .F.
