########################################################################
#                                                                      #
# Author:  Sreekanth Pannala                            Date: 01-2010  #
# Modified: J. Musser                                   Date: 05-2014  #
#                                                                      #
#  References:                                                         #
#                                                                      #
#  R. Garg, J. Galvin, T. Li, and S. Pannala, Documentation of open-   #
#     source MFIX-DEM software for gas-solids flows," from URL:        #
#     https://mfix.netl.doe.gov/documentation/dem_doc_2012-1.pdf,      #
#                                                                      #
########################################################################

  RUN_NAME    = 'PIC_SA'
  DESCRIPTION = 'PIC Test: Sphere Advection'

#_______________________________________________________________________
# RUN CONTROL SECTION

  RUN_TYPE = 'NEW'
  UNITS    = 'SI'

  TIME  = 0.0      ! start time
  TSTOP = 4.0      ! stop time

  DT     = 1.0d-3  ! time step
  DT_FAC = 1.0     ! fixed step size

  ENERGY_EQ  = .F.
  SPECIES_EQ = .F.   .F.

  MOMENTUM_X_EQ(0) = .F. .F.
  MOMENTUM_Y_EQ(0) = .F. .F.
  MOMENTUM_Z_EQ(0) = .F. .F.

  GRAVITY = 0.0

  CALL_USR = .T.

  DRAG_TYPE = 'USR_DRAG'
  DES_INTERP_SCHEME = 'LINEAR_HAT'

  DES_INTERP_ON = .T.
  DES_INTERP_MEAN_FIELDS = .T.

!  DES_CONTINUUM_COUPLED = .T.

! Used to store the initial particle position
  DES_USR_VAR_SIZE = 3


#_______________________________________________________________________
# NUMERICAL SECTION

  MAX_NIT = 250
  TOL_RESID = 1.E-3

  LEQ_SWEEP(1) = 9*'ISIS'

#_______________________________________________________________________
# GEOMETRY SECTION

  COORDINATES = 'CARTESIAN'

  XLENGTH =   1.0   IMAX = 32
  YLENGTH =   1.0   JMAX = 32
  ZLENGTH =   1.0   KMAX = 32

  CYCLIC_X = .TRUE.
  CYCLIC_Y = .TRUE.
  CYCLIC_Z = .TRUE.

  DESGRIDSEARCH_IMAX = 32
  DESGRIDSEARCH_JMAX = 32
  DESGRIDSEARCH_KMAX = 32

#_______________________________________________________________________
# MATERIAL SECTION

! Gas Section
!---------------------------------------------------------------------//

  RO_g0 = 1.2      ! (kg/m^3)
  MU_g0 = 1.8d-5   ! (Pa.s)


! Particle Section
!---------------------------------------------------------------------//
  MMAX = 1

  PARTICLES = 480

  EP_star = 0.40
  
  FRIC_EXP_PIC = 3.0
  PSFAC_FRIC_PIC = 100.0

  MPPIC_COEFF_EN1 = 0.85  
  MPPIC_COEFF_EN_WALL = 0.85  
  MPPIC_COEFF_ET_WALL = 1.00

! Solids phase 1:
!---------------------------------------------------------------------//
  SOLIDS_MODEL = 'PIC'

  D_p0  = 0.01d0     ! diameter
  RO_s0 = 2.70d3      ! density


#_______________________________________________________________________
# INITIAL CONDITIONS SECTION

  IC_X_w(1)   =   0.0
  IC_X_e(1)   =   1.0
  IC_Y_s(1)   =   0.0
  IC_Y_n(1)   =   1.0
  IC_Z_b(1)   =   0.0
  IC_Z_t(1)   =   1.0

  IC_EP_g(1)  =   1.0   ! void fraction

  IC_U_g(1)   =   0.0   ! x-dir gas velocity
  IC_V_g(1)   =   0.0   ! y-dir gas velocity
  IC_W_g(1)   =   0.0   ! y-dir gas velocity

  IC_THETA_M(1,1) = 0.0
  IC_PIC_CONST_STATWT(1,1) = 1.0 

#_______________________________________________________________________
# BOUNDARY CONDITIONS SECTION

! No boundaries. The domain is fully periodic.


  USR_DT(1) =  0.25   ! L1 Norms
  USR_DT(2) =  0.25   ! Solids/Gas volumes

#_______________________________________________________________________
# OUTPUT CONTROL SECTION

  FULL_LOG = .T.    ! display residuals on screen
  NLOG = 250        ! frequency to updated log file (.LOG)

! Output Control
  RES_DT =  0.25   ! frequency to write restart file (.RES)

  SPX_DT(1:9) = 9*1.00  ! Everything
  GROUP_RESID = .T.


  SPX_DT(1)   =   0.01  ! EPg
  SPX_DT(3)   =   0.01  ! Gas Velocity
  PRINT_DES_DATA = .T.

#_______________________________________________________________________
# DMP SETUP

! MPI partition
  NODESI = 1   NODESJ = 1   NODESK = 1

  ENABLE_DMP_LOG = .F.
  CHK_BATCHQ_END = .F.
